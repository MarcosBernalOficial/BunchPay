<div class="min-h-screen bg-black text-white">
  <!-- Header -->
  <app-page-header [showLogo]="true" [navLinks]="navLinks"></app-page-header>

  <main class="max-w-6xl mx-auto px-4 py-6 space-y-4">
    <button (click)="back()" class="px-3 py-2 rounded border border-white/30 hover:bg-white/10">← Volver</button>

    <section class="border border-white/10 rounded-xl bg-white/5 h-[70vh] flex flex-col">
      <div class="flex-1 overflow-y-auto p-4 space-y-2">
        @if (loading) {
          <div class="text-white/70 text-sm">Cargando chat…</div>
        }
        @if (!loading) {
          @for (m of messages; track m) {
            <div class="flex" [class.justify-end]="isMine(m)" [class.justify-start]="!isMine(m)">
              <div class="max-w-[75%] p-2 rounded border mb-2"
                  [class.border-white/10]="!isMine(m)" [class.bg-white/10]="!isMine(m)"
                  [class.border-white/80]="isMine(m)" [class.bg-white]="isMine(m)" [class.text-black]="isMine(m)">
                <div class="text-xs opacity-60" [class.text-right]="isMine(m)">{{ m.senderEmail || m.senderName || m.sender?.email }}</div>
                <div class="whitespace-pre-wrap">{{ m.content }}</div>
                <div class="text-[10px] opacity-50 mt-1" [class.text-right]="isMine(m)">{{ m.date | date:'short' }}</div>
              </div>
            </div>
          }
        }
      </div>
      <form [formGroup]="form" (ngSubmit)="send()" class="p-3 border-t border-white/10 flex gap-2">
        <input type="text" formControlName="content" placeholder="Escribí tu mensaje…" class="flex-1 bg-transparent border border-white/20 rounded px-3 py-2 outline-none" />
        <button type="submit" [disabled]="sending || form.invalid" class="px-4 py-2 rounded bg-white text-black cursor-pointer">Enviar</button>
      </form>
    </section>
  </main>
</div>
